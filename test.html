<style>
   .ticket-selector-category {
      margin: 5px;
   }
   .well {
      background-color: #FFFFFF;
      border-left: 5px solid #242b4c;
   }
   #left-column {
      border-style: solid;
      border-width: 1px;
      border-color: #c8c9d2;
      padding-bottom: 10px;
   }
   #row {  
      margin-right: 0px;
      margin-left: 0px;
   }
</style>

<div class="row" id="ticket-selector">
<div id="left-column" class="col-xs-12 col-sm-4" >
<h2>Ticket Selector</h2>   
<h3>Age</h3>
<div id="ticket-selector-ages">
</div>
<h3>Categories</h3>
<div id="ticket-selector-categories">
</div>
</div>
<div id="right-column" class="col-xs-12 col-sm-8"">
<h3>Results</h3>   
<div id="ticket-selector-results">
</div>
</div>
</div>

<script>
var selected = []; //the selected categories
const products =
[
 {
  "name": "free travel",
  "link": "TBC",
  "0-4 years": 5,
  "5-14 years": -5,
  "15 years older": -5,
  "primary school student": -5,
  "high school student": -5,
  "tertiary student": -5,
  "senior": -5,
  "job seeker": -5,
  "asylum seeker": -5,
  "disability": -5,
  "disability carer": -5,
  "pension": -5,
  "DVA card holder": -5,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": -5
 },
 {
  "name": "go card child",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/concessions\/children",
  "0-4 years": -5,
  "5-14 years": 5,
  "15 years older": 0,
  "primary school student": 5,
  "high school student": 3,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": -5,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": -5
 },
 {
  "name": "go card concession",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/concessions",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 3,
  "primary school student": 0,
  "high school student": 3,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 5,
  "DVA card holder": 0,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": -5
 },
 {
  "name": "go card senior & senior plus",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/concessions\/seniors",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 0,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 5,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 1,
  "DVA card holder": 1,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": -5
 },
 {
  "name": "go card stas",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/concessions\/school-students\/school-transport-assistance",
  "0-4 years": -5,
  "5-14 years": 3,
  "15 years older": 1,
  "primary school student": 3,
  "high school student": 3,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": -5
 },
 {
  "name": "go card adult",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/go-card\/about-go-card",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 3,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 5,
  "senior": 1,
  "job seeker": 5,
  "asylum seeker": 5,
  "disability": 1,
  "disability carer": 1,
  "pension": 1,
  "DVA card holder": 1,
  "tourist": 3,
  "frequent traveller": 5,
  "infrequent traveller": 3,
  "non-seq": -5
 },
 {
  "name": "go explore child",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/ticket-types\/visitors-and-tourists\/go-explore",
  "0-4 years": -5,
  "5-14 years": 2,
  "15 years older": 1,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 5,
  "frequent traveller": 0,
  "infrequent traveller": 1,
  "non-seq": -5
 },
 {
  "name": "go explore adult",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/ticket-types\/visitors-and-tourists\/go-explore",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 2,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 5,
  "frequent traveller": 0,
  "infrequent traveller": 1,
  "non-seq": -5
 },
 {
  "name": "go seeq child",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/ticket-types\/visitors-and-tourists\/go-seeq",
  "0-4 years": -5,
  "5-14 years": 2,
  "15 years older": 1,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 5,
  "frequent traveller": 0,
  "infrequent traveller": 1,
  "non-seq": -5
 },
 {
  "name": "go seeq adult",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/ticket-types\/visitors-and-tourists\/go-seeq",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 2,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 0,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 5,
  "frequent traveller": 0,
  "infrequent traveller": 1,
  "non-seq": -5
 },
 {
  "name": "access pass",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/ticket-types\/disability\/translink-access-pass",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 0,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 5,
  "disability carer": 5,
  "pension": 0,
  "DVA card holder": 0,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": 0
 },
 {
  "name": "TPI\/EDA",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/concessions\/pensioners-and-veterans",
  "0-4 years": -5,
  "5-14 years": 0,
  "15 years older": 0,
  "primary school student": 0,
  "high school student": 0,
  "tertiary student": 0,
  "senior": 0,
  "job seeker": 0,
  "asylum seeker": 0,
  "disability": 5,
  "disability carer": 0,
  "pension": 0,
  "DVA card holder": 5,
  "tourist": 0,
  "frequent traveller": 0,
  "infrequent traveller": 0,
  "non-seq": 0
 },
 {
  "name": "paper ticket",
  "link": "https:\/\/translink.com.au\/tickets-and-fares\/buy-and-refund-tickets",
  "0-4 years": -5,
  "5-14 years": 1,
  "15 years older": 1,
  "primary school student": 1,
  "high school student": 1,
  "tertiary student": 1,
  "senior": 1,
  "job seeker": 1,
  "asylum seeker": 1,
  "disability": 1,
  "disability carer": 1,
  "pension": 1,
  "DVA card holder": 1,
  "tourist": 3,
  "frequent traveller": 0,
  "infrequent traveller": 3,
  "non-seq": 5
 }
]
const categories = Object.keys(products[0]); //use the keys of the first object as categories
categories.splice(0, 2); //remove name and link field as categories
const results = [];

function evalProduct(product) { //evaluate the overall 'value' of a product given the selected filters
   var val = 0; //start at 0
   for (var i = 0; i < selected.length; i++) {
      if (product[selected[i]] != null) { //if category is shared
         val += product[selected[i]]; //increase value
      }
   }
   return result = {name:product.name, value:val, url:product.link}; //return the name, URL and value of the products
}

function select(category) { //adds selected item to array
   if (!selected.includes(category)) { //if not already selected
      selected.push(category); //add to selected list
      document.getElementById(category).classList.toggle("active"); //toggle the button active
   } else { //if already selected
      selected = selected.filter(function(e) { return e !== category }) //remove category from array
      document.getElementById(category).classList.toggle("active"); //toggle the button to inactive
   }
   evalOptions(); //update results list
}

function evalOptions() {
   results.length = 0; //wipe previous results variable
   document.getElementById('ticket-selector-results').innerHTML = ""; //wipe results on page
   if (selected.length > 0) {
      for (i = 0; i < products.length; i++) {
         results.push(evalProduct(products[i])); //gather results
      }
      results.sort((a, b) => (b.value > a.value) ? 1 : -1) //sort results by most valuable
      for (i = 0; i < 3; i++) { //for the top 3 most valued products
         if (results[i].value > 0) { //if the result doesn't have negative relevancy
            document.getElementById('ticket-selector-results').innerHTML += '<div class="well"><p>' + results[i].name + ' ' + results[i].value + '</p><p>' + results[i].url + '</p></div>'
         }
      }
   }
}

for (var i = 0; i < categories.length; i++) { //generate links via the actions list
   if (categories[i].includes("years")) { //if an age category
      document.getElementById('ticket-selector-ages').innerHTML += '<a role="button" id="' + categories[i] + '" class="btn btn-default ticket-selector-category" id="category" onclick="select(\'' + categories[i] + '\')"> ' + categories[i] + '</a>';
   } else {  
      document.getElementById('ticket-selector-categories').innerHTML += '<a role="button" id="' + categories[i] + '" class="btn btn-default ticket-selector-category" id="category" onclick="select(\'' + categories[i] + '\')"> ' + categories[i] + '</a>';
   }
}
</script>